{{ if and .Site.Params.disqusShortname (not .Params.disableComments) }}
<div class="comments-section">
  <div class="comments-header">
    <h3>Comments</h3>
  </div>
  {{ if hugo.IsServer }}
    <div class="comments-dev-notice">
      <p><strong>Note:</strong> Comments are disabled in development mode. They will appear when deployed to production.</p>
    </div>
  {{ else }}
    <div id="disqus_thread"></div>
    <script>
      var disqus_config = function () {
        this.page.url = '{{ .Permalink }}';
        this.page.identifier = '{{ .RelPermalink }}';
        this.page.title = '{{ .Title }}';
      };
      
      (function() {
        var d = document, s = d.createElement('script');
        s.src = 'https://{{ .Site.Params.disqusShortname }}.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
      })();
    </script>
    <noscript>
      <p class="comments-noscript">
        Please enable JavaScript to view the 
        <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
      </p>
    </noscript>
  {{ end }}
</div>
{{ end }}